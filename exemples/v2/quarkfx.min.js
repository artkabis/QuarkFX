const e=new class{constructor(){this.animations=new Map,this.queue=[],this.currentAnimation=null,this.defaultEasing={linear:"linear",easeInQuad:"cubic-bezier(0.55, 0.085, 0.68, 0.53)",easeOutQuad:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",easeInOutQuad:"cubic-bezier(0.455, 0.03, 0.515, 0.955)",elastic:"cubic-bezier(0.68, -0.55, 0.265, 1.55)",bounce:"cubic-bezier(0.36, 0, 0.66, -0.56)",easeOutBack:"cubic-bezier(0.34, 1.56, 0.64, 1)"}}fromTo(e,t=1e3,i,r,n={}){return new Promise((o=>{const s={selector:e,duration:t,fromProps:this._parseProperties(i),toProps:this._parseProperties(r),options:{easing:n.easing||"easeOutQuad",delay:n.delay||0,endDelay:n.endDelay||0,iterations:n.iterations||1,direction:n.direction||"normal",...n,onComplete:e=>{n.onComplete&&n.onComplete(e),o()}},type:"fromTo"};this.currentAnimation?this.queue.push(s):this._runAnimation(s)}))}to(e,t=1e3,i,r={}){return new Promise((n=>{const o={selector:e,duration:t,toProps:this._parseProperties(i),options:{easing:r.easing||"easeOutQuad",delay:r.delay||0,endDelay:r.endDelay||0,iterations:r.iterations||1,direction:r.direction||"normal",...r,onComplete:e=>{r.onComplete&&r.onComplete(e),n()}},type:"to"};this.currentAnimation?this.queue.push(o):this._runAnimation(o)}))}_parseProperties(e){const t={};for(let[i,r]of Object.entries(e))if("string"==typeof r){const e=r.match(/[%px]+$/);t[i]=e?{value:parseFloat(r),unit:e[0]}:{value:r,unit:""}}else t[i]={value:r,unit:"scale"===i?"":"px"};return t}async _runAnimation(e){this.currentAnimation=e;const t="string"==typeof e.selector?document.querySelectorAll(e.selector):[e.selector],i=[];t.forEach((t=>{let r;if("fromTo"===e.type)r=this._createKeyframes(e.fromProps,e.toProps);else{const i=this._getCurrentProperties(t,e.toProps);r=this._createKeyframes(i,e.toProps)}const n={duration:e.duration,easing:this._getEasing(e.options.easing),delay:e.options.delay,endDelay:e.options.endDelay,fill:e.options.fill||"forwards",iterations:e.options.iterations,direction:e.options.direction};try{const o=t.animate(r,n);this.animations.set(t,o);const s=new Promise((i=>{o.onfinish=()=>{e.options.onComplete&&e.options.onComplete(t),i()}}));i.push(s)}catch(e){console.error("Animation error:",e)}}));try{if(await Promise.all(i),this.currentAnimation=null,this.queue.length>0){const e=this.queue.shift();await this._runAnimation(e)}}catch(e){console.error("Animation sequence error:",e),this.currentAnimation=null}}_getEasing(e){const t={linear:"linear",easeInQuad:"cubic-bezier(0.55, 0.085, 0.68, 0.53)",easeOutQuad:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",easeInOutQuad:"cubic-bezier(0.455, 0.03, 0.515, 0.955)",elastic:"cubic-bezier(0.68, -0.55, 0.265, 1.55)",bounce:"cubic-bezier(0.36, 0, 0.66, -0.56)",easeOutBack:"cubic-bezier(0.34, 1.56, 0.64, 1)"};return"function"==typeof e?"ease-out":t[e]?t[e]:e.startsWith("cubic-bezier")?e:"ease"}_getCurrentProperties(e,t){const i=window.getComputedStyle(e),r={};for(let e in t)if("x"===e||"y"===e){const e=new DOMMatrix(i.transform);r.x={value:e.e||0,unit:"px"},r.y={value:e.f||0,unit:"px"}}else{let t=i[e];const n=t?.match(/[%px]+$/)||["px"];r[e]={value:parseFloat(t)||0,unit:n[0]}}return r}_createKeyframes(e,t){const i=["x","y","rotation","scale"];return[this._createFrame(e,i),this._createFrame(t,i)]}_createFrame(e,t){const i={},r=[];for(let[n,o]of Object.entries(e))if(t.includes(n))switch(n){case"x":r.push(`translateX(${o.value}${o.unit})`);break;case"y":r.push(`translateY(${o.value}${o.unit})`);break;case"rotation":r.push(`rotate(${o.value}deg)`);break;case"scale":r.push(`scale(${o.value})`)}else i[n]=`${o.value}${o.unit}`;return r.length&&(i.transform=r.join(" ")),i}stagger(e,t,i,r=50,n={}){const o=document.querySelectorAll(e),s=Array.from(o).map(((e,o)=>this.to(e,t,i,{...n,delay:(n.delay||0)+o*r})));return Promise.all(s)}async sequence(e){for(const[t,i,r,n]of e)await this.to(t,i,r,n);return this}async parallel(e){const t=e.map((([e,t,i,r])=>this.to(e,t,i,r)));return await Promise.all(t),this}reverse(){if(this.currentAnimation){const e={selector:this.currentAnimation.selector,duration:this.currentAnimation.duration,fromProps:this.currentAnimation.toProps,toProps:this.currentAnimation.fromProps,options:{...this.currentAnimation.options,direction:"reverse"===this.currentAnimation.options.direction?"normal":"reverse"},type:"fromTo"};this.queue.push(e)}return this}play(e){return this._getAnimations(e).forEach((e=>e.play())),this}pause(e){return this._getAnimations(e).forEach((e=>e.pause())),this}finish(e){return this._getAnimations(e).forEach((e=>e.finish())),this}loop(e,t,i,r={}){return this.to(e,t,i,{...r,iterations:1/0,direction:r.direction||"alternate"})}_getAnimations(e){if(!e)return Array.from(this.animations.values());const t="string"==typeof e?document.querySelectorAll(e):[e];return Array.from(t).map((e=>this.animations.get(e))).filter(Boolean)}};export default e;